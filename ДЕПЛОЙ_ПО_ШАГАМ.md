# Деплой по шагам (следующий этап)

После успешного теста с локальным сервером — пошаговый деплой backend в облако и подключение приложения.

---

## Шаг 1. Развернуть backend в Railway

1. Откройте в браузере **[railway.app](https://railway.app)** и войдите (через GitHub удобно).
2. Нажмите **«+ New»** → **Deploy from GitHub repo**.
3. Выберите репозиторий **Andrian0123/PROFI-A** (если не виден — настройте доступ GitHub для Railway).
4. В настройках созданного сервиса:
   - **Root Directory:** оставить пустым (или указать `server`, тогда Start Command: `node server-single.js` или `npm run start:cloud`).
   - **Start Command:** `node server/server-single.js` (из корня репозитория) или `npm run start:cloud` (если Root Directory = `server`).
   - **Build Command:** пусто или `echo "No build"`
5. В **Settings** сервиса найдите **Networking** → включите **Generate Domain**.
6. Скопируйте выданный URL (например `https://profia-backend-production-xxxx.up.railway.app`) **без** слэша в конце.

---

## Шаг 2. Подставить URL в приложение

1. Откройте в проекте файл **`app/build.gradle.kts`**.
2. В блоке `defaultConfig` найдите три строки с `AUTH_SERVER_URL`, `SUPPORT_SERVER_URL`, `SCAN_SERVER_URL`.
3. Замените значения на **один и тот же** HTTPS-URL от Railway (в кавычках, без слэша в конце), например:

```kotlin
buildConfigField("String", "AUTH_SERVER_URL", "\"https://ваш-сервис.up.railway.app\"")
buildConfigField("String", "SUPPORT_SERVER_URL", "\"https://ваш-сервис.up.railway.app\"")
buildConfigField("String", "SCAN_SERVER_URL", "\"https://ваш-сервис.up.railway.app\"")
```

4. Сохраните файл.

---

## Шаг 3. Собрать и установить приложение

- В терминале из корня проекта: **`.\СБОРКА_ПРИЛОЖЕНИЯ.ps1`**  
  или в Android Studio: **Build → Rebuild Project**.
- Установить на устройство: двойной щелчок **УСТАНОВИТЬ_И_ЗАПУСТИТЬ_ПРИЛОЖЕНИЕ.bat**  
  или в Android Studio: **Run** ▶.

После этого приложение будет обращаться к облачному backend — локальный сервер на ПК не нужен.

---

## Шаг 4. Проверка

- Вход (любой логин/пароль) и раздел «Тех. поддержка» должны работать через URL Railway.
- В браузере можно проверить: `https://ваш-URL.up.railway.app/support/tickets` — должен вернуться JSON.

---

## Вернуться к локальному серверу

Чтобы снова тестировать локально, в `app/build.gradle.kts` верните:

```kotlin
buildConfigField("String", "AUTH_SERVER_URL", "\"http://10.0.2.2:3001\"")
buildConfigField("String", "SUPPORT_SERVER_URL", "\"http://10.0.2.2:3002\"")
buildConfigField("String", "SCAN_SERVER_URL", "\"http://10.0.2.2:3003\"")
```

и пересоберите приложение.

---

Подробнее: **СЛЕДУЮЩИЕ_ШАГИ.md**, **docs/ПОШАГОВОЕ_ПОДКЛЮЧЕНИЕ_СЕРВИСОВ.md**.
