# Сканирование документа (путь фото3д)

Модуль встраиваемой ИИ-модели для **сканера документа** с параметрами (ширина, длина) и распознаванием содержимого, в т.ч. **инженерных коммуникаций** (трубы, кабели, вентиляция, электропроводка).

## API

- **POST /api/v1/scan/document** — один файл изображения (JPEG/PNG), в ответе: `width_mm`, `length_mm`, `content[]`, `has_engineering_communications`.

## Модуль

- **`app/ml/document_analyzer.py`** — функция `analyze_document(image_path, scan_id)` возвращает `DocumentScanResult` (ширина/длина в мм, список распознанных меток с confidence).

Сейчас используется **заглушка** (`_analyze_image_stub`): размеры A4 по умолчанию, две метки «инженерные_коммуникации» и «схема» с фиксированным confidence.

## Подключение своей ИИ-модели

1. В **`document_analyzer.py`** заменить или дополнить **`_analyze_image_stub`**:
   - Вход: путь к изображению (или байты).
   - Выход: `(width_mm, length_mm, [(label, confidence), ...])`.
2. Для размеров документа: использовать либо эталон в кадре (линейка/лист A4), либо модель, обученную на разметке «ширина/длина в мм».
3. Для распознавания содержимого:
   - Классификация: один вектор меток (инженерные_коммуникации, трубы, кабели, схема и т.д.) с confidence.
   - Детекция: при необходимости возвращать `bbox` в `RecognizedContentItem` (координаты в долях 0..1).

Допустимые метки заданы в **`app/models/schemas.py`** в типе **`ContentLabel`** (инженерные_коммуникации, трубы, кабели, вентиляция, электропроводка, схема, чертёж, текст, таблица, печать, подпись, другое).
