# LOLA 2.0 — Задачи на реализацию

Список задач по этапам. Отмечать выполнение: `[x]`. При необходимости добавить колонки «Ответственный» и «Срок».

---

## Легенда приоритетов

- **P0** — блокирует запуск MVP
- **P1** — важно для MVP, можно упростить
- **P2** — после MVP (этап «Рост»)
- **P3** — этап «Масштаб» или улучшения

---

## Порядок выполнения (по пунктам)

1. Утвердить MVP-персонажей и сценарии использования.
2. Собрать и согласовать промпты/правила по каждому MVP-персонажу.
3. Утвердить стек (мобилка, backend, LLM, STT/TTS).
4. Сделать wireframes и базовый UI-kit.
5. Поднять backend-скелет (auth, users, characters, chat).
6. Реализовать мобильный MVP-цикл: onboarding -> персонажи -> чат.
7. Подключить микрофон (STT) и ответ в текст/аудио (TTS).
8. Подключить подписки и paywall.
9. Провести QA: функционал, безопасность, стабильность, UX.
10. Выпустить закрытую бету (20-50 пользователей), собрать обратную связь.
11. Исправить блокирующие проблемы и подготовить релиз.
12. Запустить пострелизную аналитику и улучшения по данным.

---

## ЭТАП 0: Подготовка и дизайн

### Дизайн и требования
- [x] **0.1** Утвердить список MVP-персонажей (5–10 из команды) — P0
- [x] **0.2** Описать системные промпты/роли для каждого MVP-персонажа под выбранный LLM — P0
- [x] **0.3** Выбрать стек: мобильное приложение (нативное / Flutter / React Native) и backend — P0
- [x] **0.4** Wireframes ключевых экранов: Splash, Onboarding, Main, Чат, Пейволл, Настройки — P0
- [x] **0.5** Визуальный стиль и UI-kit (цвета, типографика, кнопки, карточки персонажей) — P1
- [x] **0.6** Макеты экрана чата с полем ввода, кнопкой микрофона и переключателем «Текст / Аудио» — P1
- [x] **0.7** Политика конфиденциальности и пользовательское соглашение (черновик) — P0

### Инфраструктура
- [ ] **0.8** Репозиторий и ветки (main, develop, feature/*) — P0
- [ ] **0.9** CI/CD для сборки и тестов (опционально с первого дня) — P1
- [x] **0.10** Выбор и настройка LLM-провайдера (API ключи, лимиты, fallback) — P0

### Обучение MVP-персонажей
- [x] **0.11** Для каждого MVP-персонажа сформировать обучающий пакет по шаблону из `docs/LOLA-2.0-training-tasks.md` — P0
- [x] **0.12** Назначить владельца и срок по каждому персонажу (10 карточек) — P0
- [ ] **0.13** Провести офлайн-оценку промптов и зафиксировать baseline-метрики (Role Fit, Safety, Helpfulness, Style) — P0
- [ ] **0.14** Утвердить DoD персонажа: «готов к продакшену / доработка» — P0

### Управление проектом
- [x] **0.15** Назначить ответственных по потокам (Product, Design, Mobile, Backend, QA, Analytics) — P0
- [x] **0.16** Оценить задачи в часах/поинтах и сформировать 2 первых спринта — P0
- [x] **0.17** Утвердить Definition of Done для MVP-фич (чат, микрофон, аудио-ответ, подписка) — P0

---

## ЭТАП 1: MVP — Backend

### Аутентификация
- [ ] **1.1** API: регистрация по email + пароль — P0
- [ ] **1.2** API: вход по email + пароль, выдача токена (JWT или иной) — P0
- [ ] **1.3** API: восстановление пароля (отправка ссылки/кода) — P1
- [ ] **1.4** API: вход через Apple / Google (OAuth) — P1
- [ ] **1.5** Обновление/продление токена и logout — P0

### Пользователи и лимиты
- [ ] **1.6** Модель пользователя: id, email, дата регистрации, тариф (free/premium), дата окончания подписки — P0
- [ ] **1.7** Подсчёт сообщений в день по пользователю для пейволла (10 для free) — P0
- [ ] **1.8** Проверка доступа к персонажам: free — только 3 из списка — P0

### Персонажи
- [ ] **1.9** Справочник персонажей: id, имя, категория, цвет, описание, системный промпт — P0
- [ ] **1.10** API: список персонажей (с фильтром по категории, поиском) — P0
- [ ] **1.11** API: один персонаж по id (для экрана профиля и чата) — P0

### Диалоги и чат
- [ ] **1.12** Модель диалога: id, user_id, character_id, created_at — P0
- [ ] **1.13** Модель сообщения: id, dialog_id, role (user/assistant), content (текст), audio_url (опционально), created_at — P0
- [ ] **1.14** API: создание диалога (при первом сообщении к персонажу) — P0
- [ ] **1.15** API: отправка сообщения пользователя → вызов LLM с промптом персонажа → сохранение ответа → возврат ответа клиенту — P0
- [ ] **1.16** API: история сообщений диалога (пагинация при необходимости) — P0
- [ ] **1.17** Учёт лимита сообщений в день при отправке (и отдача ошибки при превышении) — P0

### Голос и мультимодальность (backend)
- [ ] **1.18** Выбрать стратегию STT/TTS: нативно на устройстве или серверно; зафиксировать контракт API — P0
- [ ] **1.19** Если серверный TTS: эндпоинт генерации/кэширования аудио по тексту ответа — P1
- [ ] **1.20** Хранение/TTL аудио-файлов (cdn/object storage) и очистка устаревших — P1

### Подписка (серверная часть)
- [ ] **1.21** Webhook/обработка событий от App Store и Google Play (покупка, продление, отмена) — P0
- [ ] **1.22** Обновление статуса подписки пользователя (premium до даты X) после верификации чека — P0
- [ ] **1.23** API: текущий статус подписки пользователя (для клиента и пейволла) — P0

### Безопасность и прочее
- [ ] **1.24** HTTPS, безопасное хранение секретов, rate limiting на критичные эндпоинты — P0
- [ ] **1.25** Логирование ошибок и мониторинг (базовый) — P1
- [ ] **1.26** Модерация пользовательских запросов и ответов (базовые safety-фильтры) — P0
- [ ] **1.27** Feature flags для включения/выключения персонажей и аудио-режима — P1

---

## ЭТАП 2: MVP — Мобильное приложение

### База и навигация
- [ ] **2.1** Проект приложения, навигация (табы или drawer): Персонажи, История*, Профиль — P0
- [ ] **2.2** Splash / загрузочный экран: проверка токена → Main или Onboarding — P0
- [ ] **2.3** Хранение токена и статуса подписки на устройстве (безопасно) — P0

### Онбординг
- [ ] **2.4** Экран 1: «Что такое LOLA» + кнопка «Далее» — P0
- [ ] **2.5** Экран 2: выбор тем (психология, бизнес, творчество и т.д.) — P1
- [ ] **2.6** Экран 3: выбор 1–3 персонажей «Кого добавить первым» — P1
- [ ] **2.7** Экран 4: регистрация/вход (email + пароль, опционально Apple/Google) — P0
- [ ] **2.8** Показ онбординга только при первом запуске (флаг в хранилище) — P0

### Главный экран — Персонажи
- [ ] **2.9** Список/сетка персонажей по категориям, данные с API — P0
- [ ] **2.10** Поиск по имени/категории — P1
- [ ] **2.11** Избранное (локально или на сервере) — P2
- [ ] **2.12** Экран профиля персонажа: аватар, имя, цвет, описание, кнопка «Начать разговор» — P0

### Чат
- [ ] **2.13** Экран чата: история сообщений (пузыри user/assistant), скролл вниз — P0
- [ ] **2.14** Поле ввода текста + кнопка «Отправить» — P0
- [ ] **2.15** Отправка сообщения на API, получение ответа, добавление в историю на экране — P0
- [ ] **2.16** Индикатор загрузки во время ожидания ответа от API — P0
- [ ] **2.17** Обработка ошибок сети и лимита сообщений (сообщение + переход на пейволл) — P0

### Голосовой ввод (микрофон)
- [ ] **2.18** Кнопка «Микрофон» рядом с полем ввода — P0
- [ ] **2.19** Запись голоса (разрешение микрофона, индикатор записи) — P0
- [ ] **2.20** Остановка записи (повторное нажатие или кнопка «Стоп») — P0
- [ ] **2.21** Speech-to-Text: распознавание записи в текст (нативное API или облако) — P0
- [ ] **2.22** Подстановка распознанного текста в поле ввода с возможностью редактирования — P0
- [ ] **2.23** Обработка ошибок (нет разрешения, ошибка распознавания) — P1

### Ответ: текст или аудио
- [ ] **2.24** Переключатель в чате: «Текст» / «Аудио» (формат ответа) — P0
- [ ] **2.25** Сохранение выбора в настройках (по умолчанию — текст) — P1
- [ ] **2.26** При формате «Аудио»: запрос TTS для ответа (на устройстве или через API) — P0
- [ ] **2.27** В пузыре ответа: текст + кнопка воспроизведения аудио — P0
- [ ] **2.28** Воспроизведение: Play/Pause, прогресс (опционально — скорость) — P1
- [ ] **2.29** Кэширование сгенерированного аудио для повторного прослушивания — P2

### Подписка и пейволл
- [ ] **2.30** Интеграция In-App Purchases (StoreKit / Google Billing): продукты подписки (месяц, год) — P0
- [ ] **2.31** Экран пейволла: тарифы (Free описание, Monthly, Yearly), кнопка «Оформить», пробный период — P0
- [ ] **2.32** Показ пейволла при превышении лимита сообщений или при попытке открыть заблокированного персонажа — P0
- [ ] **2.33** Восстановление покупок и отображение статуса подписки — P0
- [ ] **2.34** В настройках: управление подпиской (ссылка в магазин / отмена) — P1

### Профиль и настройки
- [ ] **2.35** Экран профиля/настроек: учётная запись (email), подписка, тема (светлая/тёмная), выход — P0
- [ ] **2.36** Переключатель темы и сохранение выбора — P1
- [ ] **2.37** Удаление аккаунта (с подтверждением и вызовом API) — P2

### История диалогов (премиум)
- [ ] **2.38** Список диалогов (персонаж, дата, превью) — только для премиум или для всех с ограничением — P2
- [ ] **2.39** Открытие прошлого диалога и подгрузка истории сообщений — P2
- [ ] **2.40** Экспорт диалога (текст/PDF) — P3

### Качество и тестирование (mobile)
- [ ] **2.41** Unit-тесты на ключевую бизнес-логику (лимиты, paywall-триггеры, сохранение режима ответа) — P1
- [ ] **2.42** E2E-сценарии: onboarding -> чат -> лимит -> paywall -> покупка -> premium-доступ — P0
- [ ] **2.43** UI-тесты чата: микрофон, STT, переключение текст/аудио, воспроизведение TTS — P0
- [ ] **2.44** Crash reporting и базовые алерты (Sentry/Firebase Crashlytics и т.д.) — P1
- [ ] **2.45** Проверка accessibility: размеры шрифтов, контраст, tap-target кнопки микрофона — P1
- [ ] **2.46** Smoke-чеклист перед каждым релизом в TestFlight/Closed Testing — P0

---

## ЭТАП 3: Рост (после MVP)

### Персонажи и контент
- [ ] **3.1** Расширение до 30+ персонажей и наполнение промптов — P2
- [ ] **3.2** Категории и фильтры на главной — P2

### Совет директоров
- [ ] **3.3** Экран выбора 3 персонажей для «Совета директоров» — P2
- [ ] **3.4** Один запрос → 3 ответа (параллельные вызовы LLM или очередь) — P2
- [ ] **3.5** UI: отображение трёх ответов в одном экране (карточки или вкладки) — P2

### История и инсайты
- [ ] **3.6** Полноценная история диалогов для премиум с поиском/фильтром — P2
- [ ] **3.7** Простые инсайты по диалогам (темы, настроение — опционально через LLM) — P3

### Аналитика и улучшения
- [ ] **3.8** Аналитика: онбординг (шаги), выбор персонажа, отправка сообщения, показ/покупка подписки — P1
- [ ] **3.9** A/B-тесты: онбординг, пейволл, тарифы — P2
- [ ] **3.10** Push-уведомления: напоминания, «персонаж дня» — P2
- [ ] **3.11** Анализ топ-запросов пользователей и автоматический пересмотр приоритетов персонажей раз в 2 недели — P2
- [ ] **3.12** Персональные рекомендации персонажей на главной по истории запросов — P2

---

## ЭТАП 4: Масштаб (опционально)

- [ ] **4.1** Создание своего персонажа (имя, описание, промпт) — P3
- [ ] **4.2** Интеграция с календарём настроения или экспорт в заметки — P3
- [ ] **4.3** Партнёрства: консультации с психологами/коучами по запросу — P3
- [ ] **4.4** Мультиязычность (локализация UI и ответов) — P3

---

## Сводка по приоритетам

| Приоритет | Количество задач | Фокус |
|-----------|------------------|--------|
| P0 | ~45 | Запуск MVP: персонажи, auth, чат, микрофон, TTS/текст, подписка, QA-гейт |
| P1 | ~22 | Удобство и стабильность: UX, мониторинг, тесты, управление релизами |
| P2 | ~17 | Рост: история, Совет директоров, персонализация, аналитика |
| P3 | ~5 | Масштаб: свой персонаж, интеграции |

---

*Документ можно копировать в трекер (Jira, Notion, Linear и т.д.) или вести чек-лист прямо в нём.*
