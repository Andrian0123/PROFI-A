# Список задач и не доработанных ресурсов PROFI-A

**Дата:** 20.02.2026  
**Источник:** объединение STATUS_ЗАДАЧ_CANONICAL, ОТЧЁТ_НЕВЫПОЛНЕННЫХ_ЗАДАЧ, анализ кода и ресурсов.

---

## Часть 1. Список задач (по приоритету)

### Выполнено (актуально на 20.02.2026)

| № | Задача | Примечание |
|---|--------|------------|
| 1 | Auth: login/register через API | Сессия сохраняется в DataStore, при пустом AUTH_SERVER_URL — демо |
| 2 | Auth: смена пароля через API | Заголовок Authorization: Bearer, ошибки из ответа |
| 3 | Auth: 2FA через API | Локальное состояние только при успехе |
| 4 | Auth: удаление аккаунта через API | ProfileViewModel.deleteAccount + переход на SPLASH |
| 5 | Auth: выход (logout) | Очистка сессии + сброс онбординга в drawer |
| 6 | Сплэш: переход на HOME при наличии сессии | hasAuthSession() \|\| isOnboardingCompleted() |
| 7 | Комната: подстановка площади пола из 3D-скана | roomScanFloorAreaM2 в AddRoomScreen |
| 8 | Калькулятор в drawer | Пункт меню + переход (уже было в коде) |
| 9 | Ядро: комнаты, сметы, акты, КС-2/КС-3, экспорт, БД, шаблоны работ | По STATUS_ЗАДАЧ_CANONICAL |

---

### Критичный приоритет (P0)

| № | Задача | Файлы/модули | Статус |
|---|--------|--------------|--------|
| P0-1 | 3D-сканирование E2E: экран отметки участков на плане (зоны пола, стен, потолка, проёмов) по алгоритму измерения помещения | RoomScanScreen.kt, docs/АЛГОРИТМ_ИЗМЕРЕНИЯ_ПОМЕЩЕНИЯ_3D.md | Не сделано |
| P0-2 | 3D: визуализация ответа backend (coverage.web_lines, missing_zones) на превью/карте | RoomScanScreen.kt, API контракт | Не сделано |
| P0-3 | 3D: retry при ошибке /process и /finish, понятные сообщения пользователю | RoomScanScreen.kt, ScanProcessingApi.kt | Частично (Toast при недоступности) |
| P0-4 | Reset password (сброс пароля по email/ссылке) | Backend + AuthScreen или отдельный экран | Не начато |

---

### Высокий приоритет (P1)

| № | Задача | Файлы/модули | Статус |
|---|--------|--------------|--------|
| P1-1 | Support: backend endpoint для обращений вместо только mailto | server/server.js (есть /support/tickets), SupportScreen.kt, SupportApi.kt | Backend есть; Android — только mailto |
| P1-2 | Support: отправка тикета через API (текст + вложение), fallback на email | SupportScreen.kt, SupportRepository.kt | Не сделано |
| P1-3 | Виды работ: реальный контент вкладки «Общие данные» вместо GeneralDataPlaceholder | AddWorkTypesScreen.kt | Заглушка |
| P1-4 | Виды работ: реальный контент вкладки «Материалы» вместо MaterialsPlaceholder | AddWorkTypesScreen.kt | Заглушка |
| P1-5 | Этапы: контент вместо заглушки (StagesScreen использует stages_catalog; при необходимости заменить placeholder-текст на реальный список) | StagesScreen.kt, StagesReference.kt | Уточнить объём контента |

---

### Средний приоритет (P2)

| № | Задача | Файлы/модули | Статус |
|---|--------|--------------|--------|
| P2-1 | Полная локализация UI: вынести все hardcoded строки в strings.xml | См. Часть 2 | В работе |
| P2-2 | Синхронизация ключей strings во всех values* (RU, EN, RO, UZ, DE, TG, KK) | tools/check_i18n_parity.py | Периодически проверять |
| P2-3 | Документация: актуализировать ОТЧЁТ_НЕВЫПОЛНЕННЫХ_ЗАДАЧ и STATUS_ЗАДАЧ_CANONICAL с учётом выполненного Auth | Корневые отчёты, docs/STATUS_ЗАДАЧ_CANONICAL.md | Требуется обновление |
| P2-4 | ChangePasswordScreen: после успешной смены пароля показывать не dev_change_password, а нейтральное сообщение | ProfiANavHost.kt, строки | Частично (API работает, сообщение — dev) |

---

### Низкий приоритет (P3)

| № | Задача | Файлы/модули | Статус |
|---|--------|--------------|--------|
| P3-1 | UX/доступность: унифицировать и локализовать все contentDescription | См. Часть 2 (ресурсы) | Не начато |
| P3-2 | Контрастность, фокус, TalkBack для ключевых экранов | Все экраны | Не начато |
| P3-3 | Расширить тесты: негативные сценарии API и UI, E2E (комната → смета → экспорт, скан → комната) | tests/ | Частично |
| P3-4 | Убрать или заменить dev_* строки на нормальные сообщения после перехода на API | values/strings.xml, экраны | dev_delete_account больше не показывается при удалении; остальные — по мере готовности |

---

## Часть 2. Не доработанные ресурсы

### 2.1 Строки, захардкоженные в коде (нужно вынести в strings.xml)

| Файл | Строка/контекст | Статус |
|------|------------------|--------|
| AddRoomScreen.kt | «Редактировать», «Удалить» (contentDescription), «Расчёты», подписи расчётов (площадь, периметр, откосы, короба, общая сумма, скан), «Добавить проём», «Создать», «Файл», проём «Дверь/Окно … м, шт.» | ✅ Выполнено (content_desc_edit/delete, add_room_calculations, add_room_*_value, add_opening_title/summary, add_room_photo_3d_create/file) |
| GeneralEstimateScreen.kt | contentDescription «Меню», «Отмена» (TextButton) | ✅ Выполнено (content_desc_menu, cancel) |
| EditProjectScreen.kt | «Обязательное поле» | ✅ Выполнено (required_field) |
| CreateProjectScreen.kt | «Обязательное поле» | ✅ Выполнено (required_field) |
| KS2Screen.kt | contentDescription "Добавить работу" | ✅ Выполнено (content_desc_add_work) |
| Logo.kt | contentDescription "PROFI-A logo" | ✅ Выполнено (content_desc_logo) |
| KS2Screen.kt | «Номер документа», «Дата», «ИТОГО», «НДС», «ВСЕГО к оплате», «Ед. изм.», «Сумма», «Отмена», «Сохранить», placeholder «ФЕР…» | ks2_* / общие ключи |
| KS3Screen.kt | Аналогично KS2 + «Договор подряда», «от» | ks3_* |
| AboutScreen.kt | «Название: PROFI-A», «Версия: 1.0.0», «Дата обновления», «Разработчик» | about_app_name, about_version, about_update_date, about_developer |
| SubscriptionScreen.kt | «Пробный период», «Осталось дней», «Промокод», «Подписка на … Подтвердить?», «Оформить», «Отмена» | subscription_trial, subscription_trial_days_left, subscription_promocode, subscription_confirm_title, subscription_confirm_btn, cancel |
| FormKs2Ks3Screen.kt | «Тип документа», «КС-2 (Акт…)», «КС-3 (Справка…)», «Проект», «Акт (промежуточная смета)», «В проекте нет сохранённых актов», «Выберите формат», «Отмена» | form_ks2_ks3_* |
| ErrorSnackbar.kt | «Закрыть» | close / dismiss |
| EstimateExport.kt (PDF) | «Наименование работ», «Ед. изм.», «Кол-во», «Цена», «Сумма», «Итого по помещению», «Итого по работам», «Заказчик», «Подрядчик» | export_* — для PDF нужны строки из контекста приложения (stringResource не всегда доступен в export; передавать из ViewModel или константы из ресурсов) |

### 2.2 contentDescription без локализации

- ✅ GeneralEstimateScreen.kt, AddRoomScreen.kt, KS2Screen.kt, Logo.kt — переведены на stringResource (content_desc_menu, content_desc_edit, content_desc_delete, content_desc_add_work, content_desc_logo).

### 2.3 Ресурсы-заглушки (текст «раздел в разработке»)

| Ресурс | Где используется | Рекомендация |
|--------|-------------------|--------------|
| catalog_placeholder | AddWorkTypesScreen (GeneralDataPlaceholder, MaterialsPlaceholder) | Заменить на реальный контент вкладок «Общие данные» и «Материалы»; тогда ключ можно оставить для других мест или удалить |
| stages_catalog / stages_catalog_hint | StagesScreen | Если контент этапов достаточный — оставить; иначе добавить контент и при необходимости обновить тексты |

### 2.4 Dev-строки (после перехода на API часть можно убрать или заменить)

| Ключ | Использование | Рекомендация |
|------|----------------|--------------|
| dev_change_password | — | ✅ Заменён на password_changed_success в ProfiANavHost |
| dev_two_fa | ProfileScreen, если 2FA без перехода | Уже есть переход на TwoFaSettingsScreen; при необходимости оставить для fallback |
| dev_profile_photo | Профиль, фото | Оставить до реализации загрузки фото |
| dev_delete_account | Раньше при отсутствии onDeleteAccount | Сейчас не используется при удалении (вызывается API); можно оставить для fallback или удалить |

### 2.5 Локализация values*

- Проверка паритета ключей: `python tools/check_i18n_parity.py` (из корня проекта).
- ✅ Ключи из п. 2.1 (content_desc_*, password_changed_success, add_room_*_value, add_opening_summary и др.) добавлены в values, values-en и в values-de, values-ro, values-uz, values-tg, values-kk (20.02.2026).

### 2.6 Прочие ресурсы

- Drawable/иконки: при добавлении новых экранов проверить наличие иконок в res.
- Цвета: не использовать прямые хексы в экранах — только токены темы (Color.kt / colors.xml) — по QUALITY_GATES уже зафиксировано.

---

## Часть 3. Сводные таблицы

### Задачи по статусу

| Статус | Количество |
|--------|------------|
| Выполнено (в т.ч. Auth, калькулятор, площадь пола из скана) | 9+ блоков |
| P0 (критично) | 4 |
| P1 (высокий) | 5 |
| P2 (средний) | 4 |
| P3 (низкий) | 4 |

### Не доработанные ресурсы по типу

| Тип | Количество |
|-----|------------|
| Захардкоженные строки в коде (файлы) | 10+ файлов |
| contentDescription без stringResource | 4+ мест |
| Заглушки catalog_placeholder / placeholder-вкладки | 2 вкладки + этапы при необходимости |
| Dev-строки для замены/удаления | 4 ключа |
| Синхронизация values* | Регулярная проверка |

---

*Документ можно использовать для планирования спринтов и проверки локализации. Обновлять по мере выполнения задач.*
