# Выполнение задач пошагово

Краткий отчёт и чеклист: что проверено и что нужно сделать у себя.

---

## Выполнено пошагово (последняя сессия — все задачи по очереди)

| Шаг | Действие | Результат |
|-----|----------|-----------|
| 1 | Локальный сервер | ⚠️ Не запущен — запускайте **ОТКРЫТЬ_ЛОКАЛЬНЫЙ_СЕРВЕР.bat** вручную |
| 2 | Сборка приложения | ✅ **BUILD SUCCESSFUL.** APK: `app\build\outputs\apk\debug\app-debug.apk` |
| 3 | Установка на устройство | ⬜ Устройство не подключено — при подключении: **УСТАНОВИТЬ_И_ЗАПУСТИТЬ_ПРИЛОЖЕНИЕ.bat** |
| 4 | Тест в приложении | ⬜ После шагов 1 и 3: вход → тех. поддержка → отправить |
| 5–6 | Деплой / верификация | По желанию / позже |

**Сборка из терминала:** `.\СБОРКА_ПРИЛОЖЕНИЯ.ps1`  
**Проверка сервера:** двойной щелчок **ПРОВЕРИТЬ_СЕРВЕР.bat** или `.\ПРОВЕРИТЬ_СЕРВЕР.ps1`  
**Установка и запуск приложения на устройстве:** двойной щелчок **УСТАНОВИТЬ_И_ЗАПУСТИТЬ_ПРИЛОЖЕНИЕ.bat**

---

## Текущий шаг

**Проверено по шагам (все по очереди):** шаг 2 (сборка) выполнен — BUILD SUCCESSFUL; шаг 1 (сервер) и шаг 3 (устройство) требуют ручных действий (сервер не запущен, устройство не подключено).

Сейчас по очереди: **запустить локальный сервер** (ОТКРЫТЬ_ЛОКАЛЬНЫЙ_СЕРВЕР.bat) → **подключить устройство** → **УСТАНОВИТЬ_И_ЗАПУСТИТЬ_ПРИЛОЖЕНИЕ.bat** → **протестировать приложение**.

1. Запустите **ОТКРЫТЬ_ЛОКАЛЬНЫЙ_СЕРВЕР.bat** (двойной щелчок), не закрывайте окно.
2. В терминале (из корня проекта): `.\ПРОВЕРИТЬ_СЕРВЕР.ps1` — должны быть три **[OK]** (Auth, Support, Scan).
3. На устройстве откройте приложение ПРОФИ-А → войдите (любой логин/пароль) → проверьте «Тех. поддержка» → отправка обращения.

**Удобно:** переустановить и сразу запустить приложение — двойной щелчок **УСТАНОВИТЬ_И_ЗАПУСТИТЬ_ПРИЛОЖЕНИЕ.bat**. Проверить, что сервер отвечает — **ПРОВЕРИТЬ_СЕРВЕР.bat**.

**Дальше (облако):** после успешного теста — деплой backend в Railway и смена URL в приложении по шагам: **ДЕПЛОЙ_ПО_ШАГАМ.md**.

**Вся очередь шагов:** **ПОРЯДОК_ШАГОВ.md** (1–6 по порядку).

---

## ✅ Что уже сделано в проекте

| Шаг | Описание | Статус |
|-----|----------|--------|
| Репозиторий | Код на GitHub (Andrian0123/PROFI-A) | ✅ |
| URL для эмулятора | В `app/build.gradle.kts`: AUTH 10.0.2.2:3001, SUPPORT 10.0.2.2:3002, SCAN 10.0.2.2:3003 | ✅ |
| Локальный сервер | Скрипт **ОТКРЫТЬ_ЛОКАЛЬНЫЙ_СЕРВЕР.bat** в корне проекта | ✅ |
| VERIFICATION_SERVER_URL | Оставлен пустым для теста | ✅ |

---

## Что сделать дальше (пошагово)

### Шаг А. Запустить локальный backend

1. Убедитесь, что установлен **Node.js** (в терминале: `node -v` — версия 18+).
2. Двойной щелчок по **ОТКРЫТЬ_ЛОКАЛЬНЫЙ_СЕРВЕР.bat**.
3. Дождитесь в консоли строк:
   ```
   [Auth]    http://localhost:3001  (emulator: http://10.0.2.2:3001)
   [Support] http://localhost:3002  ...
   [Scan]    http://localhost:3003  ...
   ```
4. Окно **не закрывайте** на время тестов.

**Проверка:** в браузере откройте http://localhost:3002/support/tickets — должен вернуться JSON `{"tickets":[]}` (или с данными).

---

### Шаг Б. Запустить приложение на устройстве/эмуляторе

Сборка готова; при необходимости установите/запустите так:

- **Уже сделано (если устройство было подключено):** APK установлен через adb, приложение запущено.
- **Повторная установка:** (в терминале из корня проекта, путь к adb — Android SDK)  
  `& "$env:LOCALAPPDATA\Android\Sdk\platform-tools\adb.exe" install -r app\build\outputs\apk\debug\app-debug.apk`
- **Запуск приложения:**  
  `adb shell am start -n ru.profia.app/.MainActivity`
- **В Android Studio:** Run ▶ (или Shift+F10), выберите устройство/эмулятор.

**Проверка:**

- **Вход:** любой логин и пароль → «Регистрация» или «Войти» — должен открыться главный экран.
- **Тех. поддержка:** меню → «Тех. поддержка» → заполнить форму → «Отправить» — сообщение об успешной отправке на сервер.

**Если в ошибке указан порт 8080:** в проекте backend использует порты **3001, 3002, 3003**. Пересоберите приложение (Build → Rebuild) и переустановите APK.  
**Если тестируете с телефона (не эмулятор):** замените в `build.gradle.kts` адрес `10.0.2.2` на IP вашего ПК (в cmd: `ipconfig`, IPv4-адрес), добавьте этот IP в `res/xml/network_security_config.xml` в блок `<domain-config>`, затем пересоберите приложение.

---

### Шаг В. (По желанию) Деплой в Railway

Пошаговая инструкция: **ДЕПЛОЙ_ПО_ШАГАМ.md** (4 шага: создать сервис в Railway → подставить URL в `build.gradle.kts` → собрать приложение → проверить). Кратко также в **СЛЕДУЮЩИЕ_ШАГИ.md**.

---

### Шаг Г. Верификация покупок

На этапе теста ничего менять не нужно. Для продакшена позже — свой endpoint и URL в `VERIFICATION_SERVER_URL`.

---

## Чеклист проверки (из docs)

| Действие | Где проверить |
|----------|----------------|
| Логин/регистрация | Экран входа → логин/пароль → «Регистрация» или «Войти» → главный экран |
| Поддержка | Меню → «Тех. поддержка» → форма → «Отправить» → сообщение об отправке |
| Скан | Проект → комната → скан (при локальном сервере — ответ от server.js) |
| Подписка | При пустом VERIFICATION_SERVER_URL — только по Google Play на устройстве |

---

Подробнее: **docs/ПОШАГОВОЕ_ПОДКЛЮЧЕНИЕ_СЕРВИСОВ.md**, **СЛЕДУЮЩИЕ_ШАГИ.md**.
